import Main from './main'
import View from './view'


function startPlugin() {
    let manifest = {
        type: 'video',
        version: '1.1.1',
        name: 'Коллекции',
        description: '',
        component: 'cub_collections',
    }
    
    Lampa.Manifest.plugins = manifest

    Lampa.Component.add('cub_collections', Main)
    Lampa.Component.add('cub_collection', View)

    var button = '<svg width="128" height="128" viewBox="0 0 128 128" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M117.294 33.2183H10.7061C9.05531 33.2183 7.47218 33.874 6.30494 35.0413C5.13769 36.2085 4.48193 37.7916 4.48193 39.4424V105.184C4.48193 106.835 5.13769 108.418 6.30494 109.585C7.47218 110.753 9.05531 111.408 10.7061 111.408H117.294C118.944 111.408 120.527 110.753 121.695 109.585C122.862 108.418 123.518 106.835 123.518 105.184V39.4424C123.518 37.7916 122.862 36.2085 121.695 35.0413C120.527 33.874 118.944 33.2183 117.294 33.2183V33.2183ZM26.3207 91.8648C26.3184 93.7967 25.5494 95.6488 24.1825 97.0141C22.8156 98.3793 20.9627 99.1462 19.0307 99.1462C17.0988 99.1462 15.2459 98.3793 13.879 97.0141C12.5121 95.6488 11.7431 93.7967 11.7408 91.8648V52.7619C11.7431 50.8299 12.5121 48.9779 13.879 47.6126C15.2459 46.2473 17.0988 45.4805 19.0307 45.4805C20.9627 45.4805 22.8156 46.2473 24.1825 47.6126C25.5494 48.9779 26.3184 50.8299 26.3207 52.7619V91.8648ZM94.3624 96.434C94.1861 97.6065 93.6341 98.6901 92.7893 99.522C91.9445 100.354 90.8526 100.889 89.6775 101.047C72.6791 103.371 55.4432 103.368 38.4455 101.039C37.2823 100.883 36.1999 100.357 35.3582 99.5391C34.5164 98.7212 33.9597 97.6544 33.7702 96.4961C31.2966 80.4885 31.3147 64.1946 33.824 48.1926C34.0002 47.0201 34.5523 45.9366 35.397 45.1047C36.2418 44.2728 37.3338 43.7375 38.5088 43.5793C55.5073 41.2555 72.7431 41.2584 89.7408 43.5879C90.9041 43.7439 91.9864 44.2697 92.8282 45.0876C93.67 45.9055 94.2267 46.9722 94.4162 48.1305C96.8898 64.1381 96.8716 80.432 94.3624 96.434ZM116.445 91.8648C116.443 93.7967 115.674 95.6488 114.307 97.0141C112.94 98.3793 111.087 99.1462 109.156 99.1462C107.224 99.1462 105.371 98.3793 104.004 97.0141C102.637 95.6488 101.868 93.7967 101.866 91.8648V52.7619C101.868 50.8299 102.637 48.9779 104.004 47.6126C105.371 46.2473 107.224 45.4805 109.156 45.4805C111.087 45.4805 112.94 46.2473 114.307 47.6126C115.674 48.9779 116.443 50.8299 116.445 52.7619V91.8648Z" fill="CurrentColor"></path><path d="M41.6168 51.4161C39.6321 65.2724 39.6033 79.3388 41.5312 93.2031C51.3303 72.6982 66.3718 58.7718 86.6559 51.4239C71.7015 49.5501 56.5719 49.5475 41.6168 51.4161V51.4161Z" fill="CurrentColor"></path><path d="M17.9078 122.941C17.7765 123.294 17.7324 123.674 17.7796 124.047C17.8267 124.421 17.9636 124.778 18.1785 125.087C18.3934 125.397 18.68 125.649 19.0138 125.824C19.3476 125.998 19.7186 126.089 20.0953 126.089H30.5842C30.9612 126.089 31.3327 125.998 31.6667 125.823C32.0008 125.648 32.2875 125.395 32.5023 125.085L37.4 118.021H19.7391L17.9078 122.941Z" fill="CurrentColor"></path><path d="M108.448 118.021H90.7793L95.6771 125.092C95.8919 125.402 96.1787 125.656 96.5128 125.831C96.847 126.006 97.2185 126.097 97.5958 126.097H108.093C108.469 126.097 108.84 126.006 109.174 125.832C109.508 125.657 109.795 125.405 110.009 125.095C110.224 124.786 110.361 124.429 110.409 124.056C110.456 123.682 110.412 123.303 110.281 122.95L108.448 118.021Z" fill="CurrentColor"></path><path d="M26.7978 7.14924L48.8866 16.1234C44.5656 18.7137 41.6351 22.3844 40.9866 26.5278H87.2005C86.552 22.3845 83.6214 18.7138 79.3005 16.1234L101.39 7.14924C102.059 6.87742 102.592 6.35093 102.873 5.6856C103.154 5.02026 103.159 4.27059 102.887 3.60149C102.616 2.93239 102.089 2.39868 101.424 2.11776C100.758 1.83685 100.009 1.83174 99.3397 2.10356L72.0828 13.1772C66.8369 11.87 61.3504 11.87 56.1045 13.1772L28.8476 2.10356C28.5163 1.96897 28.1617 1.90095 27.8041 1.90338C27.4466 1.90582 27.0929 1.97866 26.7635 2.11776C26.4341 2.25685 26.1352 2.45947 25.8841 2.71405C25.633 2.96863 25.4344 3.27018 25.2999 3.60148C25.1653 3.93279 25.0972 4.28736 25.0997 4.64495C25.1021 5.00254 25.175 5.35615 25.314 5.68559C25.4531 6.01503 25.6558 6.31385 25.9103 6.56498C26.1649 6.81612 26.4665 7.01465 26.7978 7.14924V7.14924Z" fill="CurrentColor"></path></svg>';


    function add(){
        var button = $(`<li class="menu__item selector">
            <div class="menu__ico">
                <svg width="191" height="239" viewBox="0 0 191 239" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M35.3438 35.3414V26.7477C35.3438 19.9156 38.0594 13.3543 42.8934 8.51604C47.7297 3.68251 54.2874 0.967027 61.125 0.966431H164.25C171.086 0.966431 177.643 3.68206 182.482 8.51604C187.315 13.3524 190.031 19.91 190.031 26.7477V186.471C190.031 189.87 189.022 193.192 187.133 196.018C185.245 198.844 182.561 201.046 179.421 202.347C176.28 203.647 172.825 203.988 169.492 203.325C166.158 202.662 163.096 201.026 160.692 198.623L155.656 193.587V220.846C155.656 224.245 154.647 227.567 152.758 230.393C150.87 233.219 148.186 235.421 145.046 236.722C141.905 238.022 138.45 238.363 135.117 237.7C131.783 237.037 128.721 235.401 126.317 232.998L78.3125 184.993L30.3078 232.998C27.9041 235.401 24.8419 237.037 21.5084 237.7C18.1748 238.363 14.7195 238.022 11.5794 236.722C8.43922 235.421 5.75517 233.219 3.86654 230.393C1.9779 227.567 0.969476 224.245 0.96875 220.846V61.1227C0.96875 54.2906 3.68437 47.7293 8.51836 42.891C13.3547 38.0575 19.9124 35.342 26.75 35.3414H35.3438ZM138.469 220.846V61.1227C138.469 58.8435 137.563 56.6576 135.952 55.046C134.34 53.4343 132.154 52.5289 129.875 52.5289H26.75C24.4708 52.5289 22.2849 53.4343 20.6733 55.046C19.0617 56.6576 18.1562 58.8435 18.1562 61.1227V220.846L66.1609 172.841C69.3841 169.619 73.755 167.809 78.3125 167.809C82.87 167.809 87.2409 169.619 90.4641 172.841L138.469 220.846ZM155.656 169.284L172.844 186.471V26.7477C172.844 24.4685 171.938 22.2826 170.327 20.671C168.715 19.0593 166.529 18.1539 164.25 18.1539H61.125C58.8458 18.1539 56.6599 19.0593 55.0483 20.671C53.4367 22.2826 52.5312 24.4685 52.5312 26.7477V35.3414H129.875C136.711 35.3414 143.268 38.0571 148.107 42.891C152.94 47.7274 155.656 54.285 155.656 61.1227V169.284Z" fill="currentColor"/>
                </svg>
            </div>
            <div class="menu__text">${manifest.name}</div>
        </li>`)

        button.on('hover:enter', function () {
            Lampa.Activity.push({
                url: '',
                title: manifest.name,
                component: 'cub_collections',
                page: 1
            })
        })

        $('.menu .menu__list').eq(0).append(button)
    }

    if(window.appready) add()
    else{
        Lampa.Listener.follow('app', function (e) {
            if (e.type == 'ready') add()
        })
    }
}

if(!window.cub_collections_ready) startPlugin()